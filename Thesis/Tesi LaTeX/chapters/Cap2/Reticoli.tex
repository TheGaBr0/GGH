\section{Reticoli}
\label{sec:reticoli}
\subsection{Nozioni base}
\label{sec:nozioni}
\begin{figure}[h]
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \begin{tikzpicture}[scale=0.7, framed]
            % Draw gray dots
            \foreach \x in {-4,...,4}
                \foreach \y in {-3,...,3}
                \fill[black] (\x,\y) circle (0.1);
            
            % Draw lattice basis vectors in blue and red
            \draw[->,black,ultra thick] (0,0) -- (1,0) node[below] {$\mathbf{b}_1$};
            \draw[->,black,ultra thick] (0,0) -- (0,1) node[left] {$\mathbf{b}_2$};
            
            % Draw Cartesian axes
            \draw[->,black,thick] (-4,0) -- (4,0) node[above left] {$x$};
            \draw[->,black,thick] (0,-3) -- (0,3) node[below right] {$y$};
        \end{tikzpicture}
        \caption{${\mathcal{L} = \mathbb{Z}^n}$}
        \label{fig:lattice1a}
    \end{subfigure}
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \vspace{-10.95em}
        \begin{tikzpicture}[scale=0.725, framed]
            \clip (-4,-3) rectangle (4,3); 

            % Draw Cartesian axes
            \draw[->,black,thick] (-4,0) -- (4,0) node[above left] {$x$};
            \draw[->,black,thick] (0,-3) -- (0,3) node[below right] {$y$};
            
            \pgftransformcm{1}{0.2}{0.2}{1}{\pgfpoint{0cm}{0cm}}
            % Draw gray dots
            \foreach \x in {-4,...,4}
                \foreach \y in {-3,...,3}
                \node[draw,circle,inner sep=1pt,fill] at (\x,\y) {};
            
            % Draw lattice basis vectors in blue and red
            \draw[->,black,ultra thick] (0,0) -- (1,0) node[below] {$\mathbf{b}_1$};
            \draw[->,black,ultra thick] (0,0) -- (0,1) node[left] {$\mathbf{b}_2$};
        \end{tikzpicture}
        \vspace{0.5em}
        \caption{${\mathcal{L} = \mathbf{B} \mathbb{Z}^n} \textrm{ dove } \mathbf{B} 
        \in \mathbb{R}^{m \times n}$}
        \label{fig:lattice1b}
    \end{subfigure}
    \caption{Due esempi di strutture reticolari.}
    \label{fig:horizontal_alignment}
\end{figure}



Un reticolo è un insieme di punti in uno spazio di dimensione $n$ che forma una struttura 
periodica. Ogni punto del reticolo può essere generato come combinazione lineare di 
$n$ vettori, chiamati base, che sono linearmente indipendenti tra loro.
La struttura e le proprietà di un reticolo dipendono dai vettori di base che, 
partendo dall'origine, definiscono il suo pattern di disposizione indicando le direzioni 
e le distanze tra i punti del reticolo. \\
Una proprietà fondamentale su cui si basa la definizione di reticolo è la proprietà dei 
coefficienti integrali: la base di un reticolo ha sempre coefficienti integrali, 
il che significa che tutti i vettori nella base sono combinazioni lineari intere 
l'uno dell'altro.
I reticoli possono essere formati in diversi modi, il più comune è il reticolo quadrato 
(Figura~\ref{fig:lattice1a}) nel quale la base è ortogonale con gli assi cartesiani. 
Le altre varianti sono ottenibili applicando delle trasformazioni lineari alla base del 
reticolo quadrato (Figura~\ref{fig:lattice1b}).


I reticoli sono normalmente definiti in uno spazio bidimensionale o tridimensionale, 
ma il concetto può essere esteso a spazi di dimensioni superiori. La rappresentazione dei vettori in questa tesi è quella per riga, 
al contrario della scelta fatta dagli autori di~\cite{GGH97} che hanno utilizzato una notazione per
colonna nel loro crittosistema a chiave pubblica Goldreich Goldwasser Halevi (GGH), oggetto di questa tesi. Quindi per esempio, una matrice 
$\mathbf{B} \in \mathbb{R}^{m\times n}$ sarà divisa in vettori 
$[\mathbf{b}_1, \mathbf{b}_2, \dots, \mathbf{b}_n]$. 
\\
Una base può essere rappresentata da una matrice  
$\mathbf{B} = [\mathbf{b}_1,\mathbf{b}_2,\dots,\mathbf{b}_n] \in \mathbb{R}^{n \times n}$ 
avente, come precedentemente anticipato, i vettori base come righe.  Utilizzando la matrice come notazione, 
il reticolo generato da una matrice 
$\mathbf{B} \in \mathbb{R}^{n \times n}$ 
può essere definito come 
${\mathcal{L}(\mathbf{B}) = \bigl\{ \mathbf{x}\mathbf{B} : \mathbf{x} \in \mathbb{Z}^n \bigr\}}$, 
dove $\mathbf{x} \mathbf{B}$ 
è una comune moltiplicazione matriciale. \\
Si definisca ora l'i-esimo minimo $\lambda_i(\mathcal{L})$ come il raggio della sfera più 
piccola, centrata nell'origine, che contiene $i$ vettori linearmente indipendenti del reticolo. 
Si chiami "gap" il rapporto tra il secondo e il primo minimo, 
$\frac{\lambda_1(\mathcal{L})}{\lambda_2(\mathcal{L})}$. 
Questo valore misura la differenza relativa tra i due vettori più corti linearmente 
indipendenti del reticolo, fornendo un'indicazione importante sulla sua struttura.
Più formalmente, dati $n$ vettori linearmente indipendenti 
$\mathbf{b}_1,\dots, \mathbf{b}_n \in \mathbb{R}^n$,
il reticolo generato da essi è un set di vettori 
\[
\mathcal{L} (\mathbf{b}_1,\dots,\mathbf{b}_n) = \sum_{i=1}^{n}\mathbf{b}_i \cdot 
\mathbb{Z} = \bigl\{ {\mathbf{x} \mathbf{B} : \mathbf{x} \in \mathbb{Z}^n} \bigr\}.
\]
Lo stesso reticolo può essere generato da più basi composte ciascuna da vettori diversi
\[
    \mathcal{L} = \sum_{i=1}^{n}\mathbf{c}_i \cdot \mathbb{Z} .
\]

Il determinante di un reticolo è il valore assoluto del 
determinante della matrice base 
$\text{det}(\mathcal{L}(\mathbf{B})) = |\text{det}(\mathbf{B})|$. 
Di conseguenza, per ogni matrice unimodulare (ovvero avente determinante +1 o -1) 
$\mathbf{U} \in \mathbf{Z}^{n \times n}$, $\mathbf{U}\mathbf{B}$ è una base di 
$\mathcal{L}(\mathbf{B})$. Per verificare se due basi $\mathbf{R}$ e $\mathbf{B}$ generano
lo stesso reticolo, è possibile utilizzare la matrice pseudo-inversa e trovare un $\mathbf{U}$
tale per cui $\mathbf{U}\mathbf{R} = \mathbf{B}$.
\\
Computando $\mathbf{R}^+$, ovvero la matrice pseudo-inversa di $\mathbf{R}$, si ha che:
\[
    \mathbf{U} = \mathbf{B} \ \mathbf{R}^+.
\]
$\mathbf{R}^+$ è particolarmente facile da ottenere in questo caso in quanto $\mathbf{R}$ è 
una matrice quadrata e i suoi vettori
riga di sono linearmente indipendenti per definizione.
Di conseguenza la matrice pseudo-inversa nient'altro è che la normale inversa:
\[
    \mathbf{R}^+ = \mathbf{R}^{-1}.
\]
Si ottiene quindi che:
\[
    \mathbf{U} = \mathbf{B}\mathbf{R}^{-1}.
\]

\begin{figure}[H]
    \centering
    \begin{tikzpicture}[scale=1, framed]
        \clip (-4,-3) rectangle (4,3); 

        % Draw Cartesian axes
        \draw[->,black,thick] (-4,0) -- (4,0) node[above left] {$x$};
        \draw[->,black,thick] (0,-3) -- (0,3) node[below right] {$y$};
        
        \pgftransformcm{1}{0.2}{0.2}{1}{\pgfpoint{0cm}{0cm}}
        % Draw gray dots
        \foreach \x in {-4,...,4}
            \foreach \y in {-3,...,3}
                \node[draw,circle,inner sep=1pt,fill] at (\x,\y) {};

        % Define the vertices of the first parallelepiped
        \coordinate (A) at (0,0);
        \coordinate (B) at (1,0);
        \coordinate (C) at (1,1);
        \coordinate (D) at (0,1);

        
        % first parallelepiped
        \draw[->,black,ultra thick] (A) -- (B) node[right] {$\mathbf{b}_1$};
        \draw[->,black,ultra thick] (A) -- (D) node[above] {$\mathbf{b}_2$};

        \draw[dotted,black,ultra thick] (B) -- (C);
        \draw[dotted,black,ultra thick] (D) -- (C);

        \fill[gray!50] (A) -- (B) -- (C) -- (D) -- cycle;

        \node[] at (0.5,0.5) {\footnotesize $\mathcal{F}_1$};

        % Define the vertices of the second parallelepiped
        \coordinate (E) at (0,0);
        \coordinate (F) at (-1,-1);
        \coordinate (G) at (-1,-2);
        \coordinate (H) at (0,-1);

        % second parallelepiped
        \draw[->,black,ultra thick] (E) -- (F) node[above left] {$\mathbf{a}_1$};
        \draw[->,black,ultra thick] (E) -- (H) node[below right] {$\mathbf{a}_2$};

        \draw[dotted,black,ultra thick] (F) -- (G);
        \draw[dotted,black,ultra thick] (H) -- (G);

        \fill[gray!20] (E) -- (F) -- (G) -- (H) -- cycle;

        \node[] at (-0.7,-1.2) {\footnotesize $\mathcal{F}_2$};

    \end{tikzpicture}
    \caption{Un reticolo con due suoi domini fondamentali.}
    
\label{fig:lattice2}
\end{figure}

\begin{exmp} (Verificare che due basi generino lo stesso reticolo)
    \label{exp:basis}
    \\
    Siano $\mathbf{R}$ e $\mathbf{B}$ due basi generanti entrambi il reticolo $\mathcal{L}$
    con
    \begin{equation*}
        \mathbf{R} =
        \begin{bmatrix}
            1 & 2\\
            3 & 0
        \end{bmatrix}
        \ \text{ e } \ 
        \mathbf{B} =
        \begin{bmatrix*}[l]
            \phantom{-}5 & \phantom{-}4\\
            -6 & -6
        \end{bmatrix*}
    \end{equation*}
    allora deve esistere una matrice unimodulare $\mathbf{U}$ tale che 
    $\mathbf{U}\mathbf{R} = \mathbf{B}$. Per trovare $\mathbf{U}$ è possibile
    calcolare:
    \begin{equation*}
        \mathbf{U} = \mathbf{B}\mathbf{R}^{-1} =
        \begin{bmatrix*}[l]
            \phantom{-}2 & \phantom{-}1\\
            -3 & -1
        \end{bmatrix*}.
    \end{equation*}
    Ora è sufficiente controllare che
    \begin{equation*}
        \mathbf{U}\mathbf{R} = \mathbf{B}
        \ \text{ ovvero } \
        \begin{bmatrix*}[l]
            \phantom{-}2 & \phantom{-}1\\
            -3 & -1
        \end{bmatrix*}
        \times
        \begin{bmatrix}
            1 & 2\\
            3 & 0
        \end{bmatrix}
        =
        \begin{bmatrix*}[l]
            \phantom{-}5 & \phantom{-}4\\
            -6 & -6
        \end{bmatrix*}
    \end{equation*}
inoltre dato che $\det(\mathbf{U}) = 1$, si può affermare che $\mathbf{R}$ e $\mathbf{B}$
sono entrambe basi di $\mathcal{L}$.
\end{exmp}
\subsection{Dominio Fondamentale}
\label{sec:dominio}



Il dominio fondamentale è un concetto molto importante nei reticoli, grazie al quale è possibile
capire la struttura matematica che li compone. Data una base arbitraria $\mathbf{B}$ e un reticolo 
$\mathcal{L}$ è possibile immaginare il dominio fondamentale come un parallelepipedo 
che ha come vertice l'origine e come lati i vettori base $\mathbf{b}$ generanti il reticolo. \\
Di tale parallelepipedo è possibile calcolarne il volume $\mathcal{F}(\mathbf{B})$, il 
quale è strettamente legato al determinante del reticolo. 
È possibile osservare in Figura~\ref{fig:lattice2} un reticolo con due sue basi: nonostante 
i domini fondamentali abbiano forme diverse, l'area coperta dal loro volume è la medesima.
Come dimostrato in~\cite[sezione 7.4]{HDMRD08}, proprio come per il
determinante, il dominio fondamentale è un'invariante che è indipendente dalla scelta 
delle basi per il reticolo. Inoltre ne deriva la proprietà:
\[
    \mathcal{F}(\mathbf{B}) = \det(\mathcal{L})
\]
e ricollegandoci a quanto detto nella sezione~\ref{sec:nozioni}: 
$\mathcal{F}(\mathbf{B})$ $=$ $\det(\mathcal{L})$ $=$ $|\det(\mathbf{B})|$.\\
Una seconda proprietà fondamentale, sempre dimostrata in~\cite{HDMRD08} è che tramite il
dominio fondamentale è possibile ricostruire l'intero reticolo (Figura \ref{fig:lattice3}). 
In altre parole, ogni vettore $\mathbf{t} \in \mathbb{R}^n$ con $\mathcal{L} \subset \mathbb{R}^n $ 
può essere ottenuto sommando ripetutamente a un vettore $\mathbf{f} \in \mathcal{F}$ un 
altro vettore $\mathbf{v} \in \mathcal{L}$.
Più formalmente: 
\[
    \mathcal{F} + \mathbf{v} = 
\{ 
    \mathbf{f} + \mathbf{v} \ | \ \mathbf{f} \in \mathcal{F}, \mathbf{v} \in \mathcal{L}
\} 
\]
comprende esattamente tutti i vettori nel reticolo $\mathcal{L}$.

\begin{figure}[h]
    \centering
    \begin{tikzpicture}[framed, scale=0.8]

        \clip (-0.55,-0.65) rectangle (10,7); 

        
        % Draw Cartesian axes
        \draw[->,black,thick] (0,0) -- (10,0) node[above left] {$x$};
        \draw[->,black,thick] (0,0) -- (0,7) node[below right] {$y$};

        % Add numbers to the x-axis
        \foreach \x in {0,1,2,...,9}
        \draw (\x,0) -- (\x,-0.1) node[below] {\x};

        % Add numbers to the y-axis
        \foreach \y in {1,2,...,6}
        \draw (0,\y) -- (-0.1,\y) node[left] {\y};

        \node[draw,circle,inner sep=1.5pt,fill] at (1,2) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (3,0) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (6,0) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (9,0) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (0,6) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (4,2) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (7,2) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (10,2) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (2,4) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (5,4) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (3,6) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (6,6) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (9,6) {};
        \node[draw,circle,inner sep=1.5pt,fill] at (8,4) {};

        \draw[dotted,black,ultra thick] (1,2) -- (4,2);
        \draw[dotted,black,ultra thick] (3,0) -- (4,2);

        \fill[gray!50] (0,0) -- (3,0) -- (4,2) -- (1,2) -- cycle;
        \draw[->,black,ultra thick] (0,0) -- (1,2) node[left] {$\mathbf{b}_1$};
        \draw[->,black,ultra thick] (0,0) -- (3,0) node[above right] {$\mathbf{b}_2$};
        \node[] at (2,1) {$\mathcal{F}$};
        
        \draw[dotted,black,ultra thick] (1,2) -- (2,4);
        \draw[dotted,black,ultra thick] (2,4) -- (5,4);
        \draw[dotted,black,ultra thick] (4,2) -- (5,4);
        \draw[dotted,black,ultra thick] (6,0) -- (7,2);
        \draw[dotted,black,ultra thick] (4,2) -- (7,2);
        \draw[dotted,black,ultra thick] (7,2) -- (8,4);
        \draw[dotted,black,ultra thick] (5,4) -- (8,4);
      
        \node[] at (3,3) {$\mathcal{F} + \mathbf{b}_1$};
        \node[] at (6,3) {$\mathcal{F} + \mathbf{b}_1 + \mathbf{b}_2$};
        \node[] at (5,1) {$\mathcal{F} + \mathbf{b}_2$};
        
        
    \end{tikzpicture}
    \caption{Il dominio fondamentale comprende esattamente tutti i vettori di $\mathcal{L}$. }
    \label{fig:lattice3}
\end{figure}